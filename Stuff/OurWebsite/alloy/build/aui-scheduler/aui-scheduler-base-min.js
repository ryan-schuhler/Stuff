AUI.add("aui-scheduler-base",function(ac){var P=ac.Lang,a=P.isArray,e=P.isDate,aq=P.isFunction,I=P.isNumber,H=function(A){return(A instanceof ac.Scheduler);},t=function(A){return(A instanceof ac.SchedulerView);},aa=function(A){return(A instanceof ac.SchedulerEvent);},u=function(A){return(ac.SchedulerCalendar&&(A instanceof ac.SchedulerCalendar));},i=ac.DataType.DateMath,W=ac.WidgetStdMod,U=".",p="",q=" ",s="scheduler-base",ai="data-view-name",F="activeView",av="clearfix",E="controls",ak="controlsNode",an="current",ab="currentDate",Y="currentDateNode",aj="date",ag="endDate",ah="eventClass",N="eventRecorder",aw="events",aB="hd",w="header",au="headerNode",n="helper",S="icon",k="iconNextNode",ap="iconPrevNode",az="locale",m="name",Q="nav",M="navNode",b="navigationDateFormatter",o="next",d="nextDate",at="prev",al="prevDate",aA="rendered",L="scheduler",ax="startDate",D="strings",f="today",ad="todayNode",v="triggerNode",z="view",O="viewStack",aC="views",X="viewsNode",B=ac.getClassName,ae=B(n,av),j=B(S),ao=B(s,E),T=B(s,an,aj),g=B(s,aB),V=B(s,S,o),C=B(s,S,at),ay=B(s,Q),y=B(s,f),Z=B(s,z),h=B(s,z,p),r=B(s,aC),am='<div class="'+ao+'"></div>',x='<div class="'+T+'"></div>',c='<div class="'+g+'"></div>',aD='<a href="#" class="'+[j,V].join(q)+'">Next</a>',af='<a href="#" class="'+[j,C].join(q)+'">Prev</a>',l='<div class="'+ay+'"></div>',R='<a href="#" class="'+y+'">{today}</a>',ar='<a href="#" class="'+[Z,h].join(q)+'{name}" data-view-name="{name}">{label}</a>',J='<div class="'+r+'"></div>';var K=function(){};K.ATTRS={eventClass:{valueFn:function(){return ac.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ac.mix(K.prototype,{addEvent:function(aE){var A=this;var aF=[].concat(A.get(aw));if(ac.Array.indexOf(aF,aE)===-1){aF.push(aE);A.set(aw,aF);}},addEvents:function(aE){var A=this;ac.Array.each(A._normalizeEvents(aE),ac.bind(A.addEvent,A));},eachEvent:function(aF){var A=this;var aE=A.get(aw);ac.Array.each(aE,aF,A);},removeEvent:function(aE){var A=this;var aF=[].concat(A.get(aw));if(aF.length){ac.Array.removeItem(aF,aE);A.set(aw,aF);}},removeEvents:function(aE){var A=this;ac.Array.each(A._normalizeEvents(aE),ac.bind(A.removeEvent,A));},_normalizeEvents:function(aF){var A=this;var aE=[];aF=ac.Array(aF);ac.Array.each(aF,function(aG){if(aa(aG)){aE.push(aG);}else{if(u(aG)){if(H(A)){aG.set(L,A);}aE=aE.concat(A._normalizeEvents(aG.get(aw)));}else{aG=new (A.get(ah))(aG);aE.push(aG);}}if(H(A)){aG.set(L,A);aG.set(ah,A.get(ah));}});return aE;},_setEvents:function(aE){var A=this;return A._normalizeEvents(aE);}});ac.SchedulerEventSupport=K;var G=ac.Component.create({NAME:s,ATTRS:{activeView:{validator:t},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(aE){var A=this;return ac.DataType.Date.format(aE,{format:"%B %d, %Y",locale:A.get(az)});},validator:aq},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:e},firstDayOfWeek:{value:0,validator:I},controlsNode:{valueFn:function(){return ac.Node.create(am);}},currentDateNode:{valueFn:function(){return ac.Node.create(x);}},headerNode:{valueFn:function(){return ac.Node.create(c);}},iconNextNode:{valueFn:function(){return ac.Node.create(aD);}},iconPrevNode:{valueFn:function(){return ac.Node.create(af);}},navNode:{valueFn:function(){return ac.Node.create(l);}},todayNode:{valueFn:function(){return ac.Node.create(this._processTemplate(R));}},viewsNode:{valueFn:function(){return ac.Node.create(J);}}},HTML_PARSER:{controlsNode:U+ao,currentDateNode:U+T,headerNode:U+g,iconNextNode:U+V,iconPrevNode:U+C,navNode:U+ay,todayNode:U+y,viewsNode:U+r},UI_ATTRS:[ab],AUGMENTS:[ac.SchedulerEventSupport,ac.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[O]={};A[ak]=A.get(ak);A[Y]=A.get(Y);A[w]=A.get(au);A[k]=A.get(k);A[ap]=A.get(ap);A[M]=A.get(M);A[ad]=A.get(ad);A[X]=A.get(X);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ac.Array.each(A.get(aw),function(aE){aE.eachRepeatedEvent(function(aF){delete aF._filtered;});delete aE._filtered;});},getEventsByDay:function(aE,aF){var A=this;aE=i.safeClearTime(aE);return A._getEvents(aE,function(aG){return i.compare(aG.getClearStartDate(),aE)||(aF&&i.compare(aG.getClearEndDate(),aE));});},getIntersectEvents:function(aE){var A=this;aE=i.safeClearTime(aE);return A._getEvents(aE,function(aG){var aF=aG.getClearStartDate();var aH=aG.getClearEndDate();return(i.compare(aE,aF)||i.compare(aE,aH)||i.between(aE,aF,aH));});},sortEventsByDateAsc:function(aE){var A=this;aE.sort(function(aI,aG){var aH=aI.get(ag);var aF=aG.get(ag);var aK=aI.get(ax);var aJ=aG.get(ax);if(i.after(aK,aJ)||(i.compare(aK,aJ)&&i.before(aH,aF))){return 1;}else{return -1;}});},getViewByName:function(aE){var A=this;return A[O][aE];},getStrings:function(){var A=this;return A.get(D);},getString:function(aE){var A=this;return A.getStrings()[aE];},renderView:function(aE){var A=this;if(aE){aE.show();if(!aE.get(aA)){if(!A.bodyNode){A.setStdModContent(W.BODY,p);}aE.render(A.bodyNode);}}},plotViewEvents:function(aE){var A=this;aE.plotEvents(A.get(aw));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(F));},_afterActiveViewChange:function(aG){var aE=this;if(aE.get(aA)){var aF=aG.newVal;var A=aG.prevVal;if(A){A.hide();}aE.renderView(aF);var aH=aE.get(N);if(aH){aH.hideOverlay();}}},_afterRender:function(aE){var A=this;A.renderView(A.get(F));},_bindDelegate:function(){var A=this;A[X].delegate("click",A._onClickViewTrigger,U+Z,A);A[ak].delegate("click",A._onClickPrevIcon,U+C,A);A[ak].delegate("click",A._onClickNextIcon,U+V,A);A[ak].delegate("click",A._onClickToday,U+y,A);},_createViewTriggerNode:function(aE){var A=this;if(!aE.get(v)){var aF=aE.get(m);aE.set(v,ac.Node.create(P.sub(ar,{name:aF,label:(A.getString(aF)||aF)})));}return aE.get(v);
},_getEvents:function(aE,aH){var A=this;var aG=A.get(aw);var aF=[];ac.Array.each(aG,function(aI){if(aH.apply(A,[aI])){aF.push(aI);}else{if(aI.isRepeatableDate(aE)){var aJ=aI.repeatByDate(aE);aF.push(aJ);}}});A.sortEventsByDateAsc(aF);return aF;},_onClickToday:function(aE){var A=this;A.set(ab,A.get(F).getToday());aE.preventDefault();},_onClickNextIcon:function(aE){var A=this;A.set(ab,A.get(F).get(d));aE.preventDefault();},_onClickPrevIcon:function(aE){var A=this;A.set(ab,A.get(F).get(al));aE.preventDefault();},_onClickViewTrigger:function(aE){var A=this;var aF=aE.currentTarget.attr(ai);A.set(F,A.getViewByName(aF));aE.preventDefault();},_processTemplate:function(aE){var A=this;return P.sub(aE,A.getStrings());},_setEventRecorder:function(aE){var A=this;if(aE){aE.set(L,A);aE.set(ah,A.get(ah));}},_setViews:function(aF){var A=this;var aE=[];ac.Array.each(aF,function(aG){if(t(aG)&&!aG.get(aA)){aG.set(L,A);aG.set(ah,A.get(ah));aE.push(aG);A[O][aG.get(m)]=aG;}});if(!A.get(F)){A.set(F,aF[0]);}return aE;},syncStdContent:function(){var A=this;var aE=A.get(aC);A[M].append(A[ap]);A[M].append(A[k]);A[ak].append(A[ad]);A[ak].append(A[M]);A[ak].append(A[Y]);ac.Array.each(aE,function(aF){A[X].append(A._createViewTriggerNode(aF));});A[w].append(A[ak]);A[w].append(A[X]);A[w].addClass(ae);A.setStdModContent(W.HEADER,A[w].getDOM());},_uiSetCurrentDate:function(aH){var aE=this;var aG=aE.get(b);var A=aG.call(aE,aH);if(aE.get(aA)){var aF=aE.get(F);if(aF){aF._uiSetCurrentDate(aH);aG=aF.get(b);A=aG.call(aF,aH);}aE[Y].html(A);aE.syncEventsUI();}}}});ac.Scheduler=G;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});