AUI.add("aui-media-viewer-plugin",function(c){var i=c.Lang,j=c.Do,n="about:blank",a="body",m="href",g="iframe",e="image",p="loading",l="providers",f="src",q="mediaViewerPlugin",d="data-options",b={height:360,width:640,wmode:"embed"},k="https?://(?:www\\.)?{domain}",o="(?:[\\?&]|^){param}=([^&#]*)";var h=c.Component.create({NAME:q,NS:"media",ATTRS:{providers:{validator:i.isObject,value:{"flash":{container:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{media}" /><embed src="{media}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',matcher:/\b.swf\b/i,options:b,mediaRegex:/([^?&#]+)/},"youtube":{container:'<iframe width="{width}" height="{height}" src="http://www.youtube.com/embed/{media}" frameborder="0" allowfullscreen></iframe>',matcher:new RegExp(i.sub(k,{domain:"youtube.com"}),"i"),options:b,mediaRegex:/[\?&]v=([^&#]*)/i},"vimeo":{container:'<iframe src="http://player.vimeo.com/video/{media}?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff" width="{width}" height="{height}" frameborder="0"></iframe>',matcher:new RegExp(i.sub(k,{domain:"vimeo.com"}),"i"),options:b,mediaRegex:/\/(\d+)/}}}},EXTENDS:c.Plugin.Base,prototype:{initializer:function(s){var r=this;var t=r._handles;t.changeReqeust=r.afterHostMethod("_changeRequest",r._restoreMedia);t.close=r.beforeHostMethod("close",r.close);t.loadMedia=r.beforeHostMethod("loadImage",r.loadMedia);t.preloadImage=r.beforeHostMethod("preloadImage",r.preloadImage);},close:function(){var r=this;var t=r.get("host");var u=t.getCurrentLink();var s=r._getMediaType(u.attr("href"));if(s!=e){r._redirectIframe(n);t.setStdModContent(a,"");}},loadMedia:function(u){var x=this;var y=x.get("host");var z=x._getMediaType(u);var B=true;x._redirectIframe(n);if(z!=e){var v=x.get(l)[z];var r=y.getCurrentLink();var A=x._updateOptions(r,c.clone(v.options));var t=v.mediaRegex.exec(u);if(t){A.media=t[1];}var s=i.sub(v.container,A);y.setStdModContent(a,s);y._syncImageViewerUI();x._uiSetContainerSize(A.width,A.height);y._setAlignCenter(true);y.set(p,false);y.fire("load",{media:t});if(y.get("preloadNeighborImages")){var w=y.get("currentIndex");y.preloadImage(w+1);y.preloadImage(w-1);}B=new j.Prevent();}return B;},preloadImage:function(u){var s=this;var w=s.get("host");var v=w.getLink(u);var r=new j.Prevent();if(v){var x=v.attr(m);var t=s._getMediaType(x);if(t==e){r=true;}}return r;},_getMediaType:function(u){var r=this;var t=r.get(l);var s=e;c.some(t,function(w,v,x){return w.matcher.test(u)&&(s=v);});return s;},_redirectIframe:function(u){var r=this;var t=r.get("host.bodyNode");if(t){var s=t.one(g);if(s){s.attr(f,u);}}},_restoreMedia:function(v){var r=this;var u=r.get("host");var w=u.getCurrentLink();var t=w.attr("href");var s=r._getMediaType(t);if(s!=e&&!u.getStdModNode(a).html()){u._processChangeRequest();}},_uiSetContainerSize:function(u,s){var r=this;var v=r.get("host");var t=v.bodyNode;t.setStyles({height:s,width:u});},_updateOptions:function(s,r){var u=s.attr(d);var t=s.attr(m);c.each(r,function(y,x,z){var w=new RegExp(i.sub(o,{param:x}));var v=w.exec(u)||w.exec(t);if(v){r[x]=v[1];}});return r;},_handles:{}},DATA_OPTIONS:d,DEFAULT_OPTIONS:b,REGEX_DOMAIN:k,REGEX_PARAM:o});c.MediaViewerPlugin=h;c.MediaViewer=c.ImageViewer;},"@VERSION@",{requires:["aui-image-viewer-base"],skinnable:false});